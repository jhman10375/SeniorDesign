@if (isMobile) {
  @if (!draftStarted && beforeDraftDate) {
    <H2
      >Draft has not started yet, check back on
      {{ activeLeague?.DraftDate | date: "M/d/yy" }} at
      {{ activeLeague?.DraftDate | date: "h:mm a" }}</H2
    >
  } @else if (!draftStarted) {
    <draft-otp
      [isLeagueManager]="activeLeague?.Manager?.ID == activeUser?.ID"
      [draftKey]="draftKey"
      [displayWaitingRoom]="inWaitingRoom()"
      [connectedUsers]="connectedUsers"
      [webSocketError]="webSocketError()"
      (createDraft)="onCreateDraft()"
      (joinDraft)="onJoinDraft($event)"
      (enterDraft)="onEnterDraft()"
    ></draft-otp>
  } @else {
    <p-toast />
    <div class="grid-container w-full">
      <div class="grid-header max-w-full">
        <draft-nav
          [currentNav]="(viewablePage | async) ?? DraftNavEnum.Main"
          (navigate)="navigateToRoute($event)"
        ></draft-nav>
        <draft-pick-order
          [selectionTime]="
            activeLeague?.Settings?.DraftSettingsModel?.SelectionTime ?? 0
          "
          [draftOrder]="(draftOrder | async) ?? []"
          [pickOrder]="(pickOrder | async) ?? []"
          [pickUpdated]="(pickUpdated | async) ?? false"
          [currentPick]="currentPick | async"
          [pickMade]="pickMade | async"
          [endDraft]="(endDraft | async) ?? false"
          (timerEnd)="onUpdateCurrentPick()"
        ></draft-pick-order>
      </div>
      <div class="grid-content max-w-full surface-border border-round border-1">
        @switch (viewablePage | async) {
          @case (DraftNavEnum.Main) {
            <div class="pb-2 pl-2 pr-2">
              <draft-main
                [leagueType]="activeLeague?.LeagueType ?? SportEnum.None"
                [athletes]="(athletes$ | async) ?? []"
                [queue]="(queue$ | async) ?? []"
                [currentlyPicking]="
                  (currentPick | async)?.Player?.ID
                    ? (currentPick | async)?.Player?.ID == activeUser?.ID
                      ? true
                      : false
                    : false
                "
                [endDraft]="(endDraft | async) ?? false"
                (addToQueueEmitter)="onAddToQueue($event)"
                (addToRosterEmitter)="onAddToRoster($event)"
                (dialogPlayerEmitter)="showDialog($event)"
                (searchEmitter)="onSearch()"
              ></draft-main>
            </div>
          }
          @case (DraftNavEnum.Player) {
            <div class="p-2"> <draft-player></draft-player></div>
          }
          @case (DraftNavEnum.Queue) {
            <div class="pb-2 pl-2 pr-2">
              <draft-queue
                [leagueType]="activeLeague?.LeagueType ?? SportEnum.None"
                [athletes]="(queue$ | async) ?? []"
                [currentlyPicking]="
                  (currentPick | async)?.Player?.ID
                    ? (currentPick | async)?.Player?.ID == activeUser?.ID
                      ? true
                      : false
                    : false
                "
                [endDraft]="(endDraft | async) ?? false"
                (addToRosterEmitter)="onAddToRoster($event)"
                (removeFromRosterEmitter)="onRemoveFromQueue($event)"
                (dialogPlayer)="showDialog($event)"
              ></draft-queue
            ></div>
          }
          @case (DraftNavEnum.MySelections) {
            <div class="pb-2 pl-2 pr-2">
              <draft-my-selections
                [leagueType]="activeLeague?.LeagueType ?? SportEnum.None"
                [athletes]="(myTeam | async) ?? []"
                (dialogPlayer)="showDialog($event)"
              ></draft-my-selections
            ></div>
          }
          @case (DraftNavEnum.Selections) {
            <draft-selections
              [selections]="(draftSelections | async) ?? []"
              [numberOfRounds]="numberOfRounds"
              (dialogPlayer)="showDialog($event)"
            ></draft-selections>
          }
          @case (DraftNavEnum.None) {
            <div class="p-2"> <draft-main></draft-main></div>
          }
          @default {
            <div class="p-2"> <draft-main></draft-main></div>
            <draft-main></draft-main>
          }
        }
      </div>
    </div>
  }
}

<p-dialog
  header="Header"
  [(visible)]="playerDialogVisible"
  [modal]="true"
  [style]="{
    'min-height': '75%',
    'max-height': '75%',
    'min-width': '100%',
    'max-width': '100%',
  }"
>
  <ng-template pTemplate="header">
    <div class="inline-flex align-items-center justify-content-center gap-2">
      <p-avatar [image]="playerDialogPlayer().Logos[0]" shape="circle" />
      <span class="font-bold white-space-nowrap">
        {{ playerDialogPlayer().Name }}
      </span>
    </div>
  </ng-template>
  <player-header
    [player]="playerDialogPlayer()"
    [draftModal]="true"
  ></player-header>
  <div
    class="flex flex-row justify-content-between align-items-center surface-border border-bottom-1 pb-2"
  >
    <span>Team:</span>
    <span>{{ playerDialogPlayer().School }}</span>
  </div>
  <div
    class="flex flex-row justify-content-between align-items-center surface-border border-bottom-1 pb-2 pt-2"
  >
    <span>Height:</span>
    <span>{{ playerDialogPlayer().Height | heightPipe: "feet" }}</span>
  </div>
  <div
    class="flex flex-row justify-content-between align-items-center surface-border border-bottom-1 pb-2 pt-2"
  >
    <span>Weight:</span>
    <span>{{ playerDialogPlayer().Weight }} lbs</span>
  </div>
  <div
    class="flex flex-row justify-content-between align-items-center surface-border border-bottom-1 pb-2 pt-2"
  >
    <span>Year:</span>
    @switch (playerDialogPlayer().Year) {
      @case (1) {
        <span>Freshman</span>
      }
      @case (2) {
        <span>Sophomore</span>
      }
      @case (3) {
        <span>Junior</span>
      }
      @case (4) {
        <span>Senior</span>
      }
    }
  </div>
  <draft-player
    [leagueType]="activeLeague?.LeagueType ?? SportEnum.None"
    [player]="playerDialogPlayer()"
  ></draft-player>
</p-dialog>

<p-dialog
  header="Header"
  [(visible)]="searchDialogVisible"
  [modal]="true"
  [style]="{
    'min-height': '75%',
    'max-height': '75%',
    'min-width': '100%',
    'max-width': '100%',
  }"
>
  <ng-template pTemplate="header">
    <div class="inline-flex align-items-center justify-content-center gap-2">
      <i class="pi pi-search"></i>
      <span class="font-bold white-space-nowrap"> Player Search </span>
    </div>
  </ng-template>
  <player-search
    [draftMode]="true"
    [leagueType]="activeLeague?.LeagueType ?? SportEnum.None"
    [athletes]="searchAthletes()"
    [myPick]="
      (currentPick | async)?.Player?.ID
        ? (currentPick | async)?.Player?.ID == activeUser?.ID
          ? true
          : false
        : false
    "
    [endDraft]="(endDraft | async) ?? false"
    [queue]="(queue$ | async) ?? []"
    (dialogPlayerEmitter)="showDialog($event)"
    (addToQueueFromSearchEmitter)="onAddToFromSearch(true, $event)"
    (addToRosterFromSearchEmitter)="onAddToFromSearch(false, $event)"
  ></player-search>
</p-dialog>
